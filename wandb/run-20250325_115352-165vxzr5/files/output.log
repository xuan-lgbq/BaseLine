Step 5: Loss = 36.54737854003906
Traceback (most recent call last):
  File "/Users/xuanxuan/Documents/藤校/Loss Landspace and Hessian Paper List/Code/Low Rank/2 NN/train.py", line 90, in <module>
    cos_similarity_Between_Hessian_invariant = abs(cosine_similarity(invariant_eigenvectors, Hessian_max_eigenvectors)[0][0])
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/metrics/pairwise.py", line 1679, in cosine_similarity
    X, Y = check_pairwise_arrays(X, Y)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/metrics/pairwise.py", line 185, in check_pairwise_arrays
    X = check_array(
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1050, in check_array
    raise ValueError(msg)
ValueError: Expected 2D array, got 1D array instead:
array=[-0.06465979 -0.0714034   0.10811291  0.07266331 -0.00553469 -0.09024688
 -0.0176264  -0.0240677   0.06465773 -0.06561872 -0.01762234 -0.01946024
  0.02946503  0.01980362 -0.00150842 -0.02459583 -0.00480389 -0.0065594
  0.01762178 -0.01788368 -0.08345627 -0.09216024  0.13954115  0.09378642
 -0.00714361 -0.11648149 -0.02275037 -0.03106414  0.08345363 -0.08469396
  0.11658923  0.12874874 -0.19494033 -0.13102053  0.00997969  0.16272576
  0.03178249  0.04339691 -0.11658552  0.11831829 -0.04079354 -0.04504805
  0.0682079   0.04584293 -0.00349181 -0.05693631 -0.01112041 -0.0151842
  0.04079225 -0.04139853  0.11601401  0.12811354 -0.19397855 -0.13037412
  0.00993045  0.16192293  0.03162568  0.0431828  -0.11601032  0.11773454
 -0.09063818 -0.10009117  0.15154949  0.1018573  -0.00775836 -0.1265054
 -0.02470817 -0.03373739  0.09063531 -0.09198238 -0.02083895 -0.02301232
  0.03484328  0.02341837 -0.00178375 -0.02908531 -0.00568074 -0.00775668
  0.02083828 -0.02114799  0.03241862  0.03579968 -0.05420481 -0.03643136
  0.00277494  0.04524728  0.00883739  0.01206688 -0.03241759  0.0328994
  0.11317571  0.12497924 -0.18923286 -0.12718451  0.0096875   0.15796147
  0.03085196  0.04212633 -0.11317212  0.11485416  0.08405141  0.09281744
 -0.14053622 -0.09445521  0.00719455  0.11731212  0.0229126   0.03128566
 -0.08404873  0.08529792 -0.04814717 -0.05316861  0.08050336  0.05410678
 -0.00412125 -0.0671999  -0.01312503 -0.01792137  0.04814564 -0.04886121
 -0.07599057 -0.0839159   0.12705828  0.08539661 -0.00650457 -0.10606146
 -0.0207152  -0.02828525  0.07598816 -0.07711754  0.00946937  0.01045697
 -0.01583304 -0.01064148  0.00081055  0.01321658  0.00258137  0.00352469
 -0.00946907  0.00960981 -0.00804773 -0.00888706  0.01345602  0.00904387
 -0.00068886 -0.01123237 -0.00219383 -0.00299553  0.00804747 -0.00816708
  0.1321437   0.14592548 -0.22094785 -0.14850034  0.01131111  0.18443546
  0.03602267  0.04918661 -0.13213952  0.13410346].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
Traceback (most recent call last):
  File "/Users/xuanxuan/Documents/藤校/Loss Landspace and Hessian Paper List/Code/Low Rank/2 NN/train.py", line 90, in <module>
    cos_similarity_Between_Hessian_invariant = abs(cosine_similarity(invariant_eigenvectors, Hessian_max_eigenvectors)[0][0])
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/utils/_param_validation.py", line 213, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/metrics/pairwise.py", line 1679, in cosine_similarity
    X, Y = check_pairwise_arrays(X, Y)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/metrics/pairwise.py", line 185, in check_pairwise_arrays
    X = check_array(
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/site-packages/sklearn/utils/validation.py", line 1050, in check_array
    raise ValueError(msg)
ValueError: Expected 2D array, got 1D array instead:
array=[-0.06465979 -0.0714034   0.10811291  0.07266331 -0.00553469 -0.09024688
 -0.0176264  -0.0240677   0.06465773 -0.06561872 -0.01762234 -0.01946024
  0.02946503  0.01980362 -0.00150842 -0.02459583 -0.00480389 -0.0065594
  0.01762178 -0.01788368 -0.08345627 -0.09216024  0.13954115  0.09378642
 -0.00714361 -0.11648149 -0.02275037 -0.03106414  0.08345363 -0.08469396
  0.11658923  0.12874874 -0.19494033 -0.13102053  0.00997969  0.16272576
  0.03178249  0.04339691 -0.11658552  0.11831829 -0.04079354 -0.04504805
  0.0682079   0.04584293 -0.00349181 -0.05693631 -0.01112041 -0.0151842
  0.04079225 -0.04139853  0.11601401  0.12811354 -0.19397855 -0.13037412
  0.00993045  0.16192293  0.03162568  0.0431828  -0.11601032  0.11773454
 -0.09063818 -0.10009117  0.15154949  0.1018573  -0.00775836 -0.1265054
 -0.02470817 -0.03373739  0.09063531 -0.09198238 -0.02083895 -0.02301232
  0.03484328  0.02341837 -0.00178375 -0.02908531 -0.00568074 -0.00775668
  0.02083828 -0.02114799  0.03241862  0.03579968 -0.05420481 -0.03643136
  0.00277494  0.04524728  0.00883739  0.01206688 -0.03241759  0.0328994
  0.11317571  0.12497924 -0.18923286 -0.12718451  0.0096875   0.15796147
  0.03085196  0.04212633 -0.11317212  0.11485416  0.08405141  0.09281744
 -0.14053622 -0.09445521  0.00719455  0.11731212  0.0229126   0.03128566
 -0.08404873  0.08529792 -0.04814717 -0.05316861  0.08050336  0.05410678
 -0.00412125 -0.0671999  -0.01312503 -0.01792137  0.04814564 -0.04886121
 -0.07599057 -0.0839159   0.12705828  0.08539661 -0.00650457 -0.10606146
 -0.0207152  -0.02828525  0.07598816 -0.07711754  0.00946937  0.01045697
 -0.01583304 -0.01064148  0.00081055  0.01321658  0.00258137  0.00352469
 -0.00946907  0.00960981 -0.00804773 -0.00888706  0.01345602  0.00904387
 -0.00068886 -0.01123237 -0.00219383 -0.00299553  0.00804747 -0.00816708
  0.1321437   0.14592548 -0.22094785 -0.14850034  0.01131111  0.18443546
  0.03602267  0.04918661 -0.13213952  0.13410346].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
